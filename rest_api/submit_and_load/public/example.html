<!DOCTYPE html>
<meta charset="utf-8">
<style> /* set the CSS http://hijiangtao.github.io/ss-vis-component/ */
      body {
          background-color: pink;
          font: 20px Arial;
      }
      body {
          margin:50px auto;
          width:1250px;
      }

      text {
        font: 20px sans-serif;
      }
      svg {
        background: yellow;
        border: 2px solid black;
      }
      #chart svg {
        background: green;
        border: 2px solid black;
      }

      #chart rect{
        fill: #4aaeea;
      }

      #chart text{
        fill: black;
        font: 10px sans-serif;
        text-anchor: end;
      }
      #chart {
        float: right;
      }
</style>

<body>
    <center>Visualizing word ditribution within your chosen site</center>
    <br>
<!-- load the d3.js library -->
<div id="chart"></div>
<script src="http://d3js.org/d3.v3.min.js"></script>

<script>
var margin ={top:20, right:30, bottom:30, left:40},
    width=500-margin.left - margin.right,
    height=500-margin.top-margin.bottom;

// scale to ordinal because x axis is not numerical
var x = d3.scale.ordinal().rangeRoundBands([0, width], .1);

//scale to numerical value by height
var y = d3.scale.linear().range([height, 5]);

var chart = d3.select("#chart")
              .append("svg")  //append svg element inside #chart
              .attr("width", width+(2*margin.left)+margin.right)    //set width
              .attr("height", height+margin.top+margin.bottom);  //set height
var xAxis = d3.svg.axis()
              .scale(x)
              .orient("bottom");  //orient bottom because x-axis will appear below the bars

var yAxis = d3.svg.axis()
              .scale(y)
              .orient("left");

// create a barChart

d3.json("./wordcounter.json", function(error, data) {
  x.domain(data.map(function(d){ return d.name}));
  y.domain([0, d3.max(data, function(d){return d.quantity})]);


  var bar = chart.selectAll("g")
                  .data(data)
                .enter()
                  .append("g")
                  .attr("transform", function(d, i){
                    return "translate("+x(d.name)+", 0)";
                  });

                  bar.append("rect")
                      .attr("y", function(d) {
                        return y(d.quantity);
                      })
                      .attr("x", function(d,i){
                        return x.rangeBand()+(margin.left/4);
                      })
                      .attr("height", function(d) {
                        return height - y(d.quantity);
                      })
                      .attr("width", x.rangeBand());

                      bar.append("text")
                          .attr("x", x.rangeBand()+margin.left )
                          .attr("y", function(d) { return y(d.frequency) -10; })
                          .attr("dy", ".75em")
                          .text(function(d) { return d.frequency; });

                          chart.append("g")
                                  .attr("class", "x axis")
                                  .attr("transform", "translate("+margin.left+","+ height+")")
                                  .call(xAxis);

                                  chart.append("g")
      .attr("class", "y axis")
      .attr("transform", "translate("+margin.left+",0)")
      .call(yAxis)
      .append("text")
      .attr("transform", "rotate(-90)")
      .attr("y", 6)
      .attr("dy", ".71em")
      .style("text-anchor", "end")
      .text("Frequency");

});

function type(d) {
    d.name = +d.name; // coerce to number
    return d;
  }


d3.json("./wordcounter.json", function(error, data) {

  var w = 400;
  var h = 350;
  var color = d3.scale.category10();

  var canvas = d3.select("body")
      .append("svg")
      .attr("width" , w)
      .attr("height" , h);

  canvas.selectAll("rect")
      .data (data)
      .enter()
        .append("rect")
        .attr("width", function (d) {return d.quantity * 20; })
        .attr("height", 48)
        .attr("y", function (d ,i){return i * 50; })
        .attr("fill", function(d, i) { return color(i%5); })
  canvas.selectAll("text")
      .data(data)
      .enter()
        .append("text")
        .attr("fill" , "black")
        .attr("y", function (d ,i){return i * 50 + 24; })
        .text(function (d) { return d.name + ' : '+ d.quantity; })



})



// var newBar = barChart(words, ["name", "quantity"]);
</script>
</body>
