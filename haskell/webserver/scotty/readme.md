inspired by [The wai package](http://hackage.haskell.org/package/wai)